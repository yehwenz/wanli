import{d as E,u as $,s as J,a as K,b as O,c as Q,r as S,o as X,e as Y,j as Z,f as ee,w as l,p as te,g as i,h as d,i as ae,v as oe,k as o,l as s,m as A,n as u,q as se,F as z,t as _,x as h,y as D,z as le,A as ne,_ as ce}from"./index-DkzAPJNB.js";import{C as M}from"./CounMasterInfo-PZ6IITpm.js";import{u as re,H as de}from"./TableHeader-CiUJ5xRo.js";import{S as ie}from"./SearchText-7uKoE6o6.js";const ue={class:"SearchPosition"},ve={class:"text-center table"},pe={key:1},me={key:2},_e={key:0},he=["colspan"],ge={class:"detail"},xe=["colspan"],Se=["colspan"],fe={colspan:"2",class:"text-end"},Ce=E({__name:"ToBeConsulted2",setup(be){const{CTable1:f,CTableMobile1:N}=de(),{axiosIns:w}=$(),{token:P}=J(K()),{StateColor:U,StateText:F,debounce:G}=re(),C=O(),T=Q(()=>C.xs.value?N:f),v=S([]),e=S({ItemPerPage:20,ItemsLength:0,Items:[],Loading:!1,Search:"",Title:"已處理列表",Width:"200px",CodeSet:[]}),p=S(1),L=S([]),b=S(!1);X(()=>{setTimeout(()=>{b.value=!0},600)}),Y(()=>{b.value=!1});const B={headers:{Authorization:`Bearer ${P.value}`}},H=Z(P.value).userid,V=async(a,n,y,I)=>{var x;const g={PageIndex:a,PageSize:n,UserName:I,Receiver:H,SortBy:(x=y[0])==null?void 0:x.order};await w.post("Counseling/master/TBConsultedTable",g,B).then(m=>{e.value.Items=m.data.counMasterTable,e.value.ItemsLength=m.data.counMasterTableCount}).catch(m=>{console.log(m),e.value.Items=[],e.value.ItemsLength=e.value.Items.length}),e.value.Loading=!1};(async()=>{await w.get("api/CodeSet/CMState",B).then(a=>e.value.CodeSet=a.data).catch(()=>{e.value.CodeSet=[]})})(),te("uploadData",()=>V(p.value,e.value.ItemPerPage,L.value,e.value.Search));const R=a=>{e.value.Loading=!0,e.value.Items=[],j(a)},j=G(a=>{p.value=a.page,e.value.ItemPerPage=a.itemsPerPage,L.value=a.sortBy,V(a.page,a.itemsPerPage,a.sortBy,a.search)},500);return(a,n)=>{const y=i("v-toolbar-title"),I=i("v-toolbar"),g=i("v-btn"),x=i("v-dialog"),m=i("v-pagination"),W=i("v-data-table-server"),q=i("v-container");return d(),ee(q,{fluid:""},{default:l(()=>[ae(o("div",ue,[s(ie,{modelValue:e.value.Search,"onUpdate:modelValue":n[0]||(n[0]=t=>e.value.Search=t)},null,8,["modelValue"])],512),[[oe,b.value]]),s(W,{height:"75vh",items:e.value.Items,expanded:v.value,"onUpdate:expanded":n[2]||(n[2]=t=>v.value=t),page:p.value,"onUpdate:page":n[3]||(n[3]=t=>p.value=t),"items-length":e.value.ItemsLength,"items-per-page":"20","item-value":"cmid",headers:T.value,search:e.value.Search,"onUpdate:options":R,class:"table-sticky",loading:e.value.Loading,"show-expand":_(C).xs.value},{top:l(()=>[s(I,{flat:""},{default:l(()=>[s(y,{class:"font-weight-bold text-center text-sm-h5"},{default:l(()=>[A("待諮商申請列表")]),_:1})]),_:1})]),item:l(({item:t})=>[o("tr",ve,[(d(!0),u(z,null,se(T.value,c=>(d(),u("td",{key:c.key},[c.key==="cmState"?(d(),u("span",{key:0,style:ne({color:_(U)(t.cmState)})},h(_(F)(t.cmState,e.value.CodeSet)),5)):c.key==="action"?(d(),u("span",pe,[s(x,{activator:"parent",persistent:"","max-width":"1000px"},{activator:l(({props:r})=>[s(g,D({size:"small",color:"info",text:"查看",ref_for:!0},r),null,16)]),default:l(({isActive:r})=>[s(M,{id:t.cmid,isActive:r.value,onIsActive:k=>r.value=k},null,8,["id","isActive","onIsActive"])]),_:2},1024)])):c.key==="data-table-expand"?(d(),u("span",me,[s(g,{icon:v.value[0]==t.cmid?"mdi-chevron-up":"mdi-chevron-down",variant:"text",size:"small",onClick:()=>v.value[0]==t.cmid?v.value=[]:v.value=[t.cmid]},null,8,["icon","onClick"])])):(d(),u(z,{key:3},[A(h(t[c.key]),1)],64))]))),128))])]),"expanded-row":l(({columns:t,item:c})=>[_(C).xs.value?(d(),u("tr",_e,[o("td",{colspan:t.length,class:"pa-0"},[o("table",ge,[o("tr",null,[o("th",null,h(_(f)[1].title),1),o("td",{colspan:t.length-1},h(c.userName),9,xe)]),o("tr",null,[o("th",null,h(_(f)[2].title),1),o("td",{colspan:t.length-1},h(c.topics),9,Se)]),o("tr",null,[o("td",fe,[s(x,{activator:"parent",persistent:"","max-width":"1000px"},{activator:l(({props:r})=>[s(g,D({size:"small",color:"info",text:"查看"},r),null,16)]),default:l(({isActive:r})=>[s(M,{id:c.cmid,isActive:r.value,onIsActive:k=>r.value=k},null,8,["id","isActive","onIsActive"])]),_:2},1024)])])])],8,he)])):le("",!0)]),bottom:l(()=>[s(m,{modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=t=>p.value=t),length:Math.ceil(e.value.ItemsLength/20),"total-visible":3},null,8,["modelValue","length"])]),_:1},8,["items","expanded","page","items-length","headers","search","loading","show-expand"])]),_:1})}}}),Te=ce(Ce,[["__scopeId","data-v-1830fce3"]]);export{Te as default};
